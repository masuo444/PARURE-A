<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚¬ã‚¤ãƒ‰ - FOMUS PARURE</title>
    
    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://js.stripe.com https://cdn.tailwindcss.com https://fonts.googleapis.com;
        style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com;
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data: https: blob:;
        connect-src 'self' https://api.stripe.com https://checkout.stripe.com;
        frame-src https://js.stripe.com https://hooks.stripe.com;
        object-src 'none';
        base-uri 'self';
        form-action 'self' https://checkout.stripe.com;
    ">
    
    <!-- Security Headers (for server configuration reference) -->
    <!-- X-Frame-Options: DENY -->
    <!-- X-Content-Type-Options: nosniff -->
    <!-- X-XSS-Protection: 1; mode=block -->
    <!-- Strict-Transport-Security: max-age=31536000; includeSubDomains; preload -->
    <!-- Referrer-Policy: strict-origin-when-cross-origin -->
    <!-- Permissions-Policy: geolocation=(), microphone=(), camera=() -->
    
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        
        .security-guide {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #27ae60;
            border-bottom: 3px solid #27ae60;
            padding-bottom: 10px;
        }
        
        h2 {
            color: #2c3e50;
            margin-top: 30px;
        }
        
        .critical {
            background: #ffe6e6;
            border-left: 4px solid #e74c3c;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .medium {
            background: #fff8e1;
            border-left: 4px solid #f39c12;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .low {
            background: #e8f5e8;
            border-left: 4px solid #27ae60;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 14px;
            margin: 15px 0;
        }
        
        .recommendation {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        ul {
            padding-left: 25px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            color: white;
        }
        
        .status.critical { background: #e74c3c; }
        .status.medium { background: #f39c12; }
        .status.low { background: #27ae60; }
    </style>
</head>
<body>
    <div class="security-guide">
        <h1>ğŸ”’ FOMUS PARURE ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã‚¬ã‚¤ãƒ‰</h1>
        
        <div class="critical">
            <h3><span class="status critical">CRITICAL</span> ç·Šæ€¥å¯¾å¿œãŒå¿…è¦ãªå•é¡Œ</h3>
            <p>ã“ã‚Œã‚‰ã®å•é¡Œã¯å³åº§ã«å¯¾å¿œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
        </div>
        
        <h2>1. Content Security Policy (CSP) ã®å®Ÿè£…</h2>
        <div class="critical">
            <p><strong>å•é¡Œ:</strong> CSPãƒ˜ãƒƒãƒ€ãƒ¼ãŒå®Ÿè£…ã•ã‚Œã¦ã„ãªã„</p>
            <p><strong>ãƒªã‚¹ã‚¯:</strong> XSSæ”»æ’ƒã€ã‚³ãƒ¼ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã€ãƒ‡ãƒ¼ã‚¿ç›—å–ã®è„†å¼±æ€§</p>
            <p><strong>å½±éŸ¿:</strong> æ‚ªæ„ã®ã‚ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆãŒä»»æ„ã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰å®Ÿè¡Œå¯èƒ½</p>
        </div>
        
        <div class="recommendation">
            <h4>æ¨å¥¨è¨­å®š:</h4>
            <div class="code-block">
&lt;meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://js.stripe.com;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com;
    img-src 'self' data: https: blob:;
    connect-src 'self' https://api.stripe.com;
    frame-src https://js.stripe.com;
    object-src 'none';
"&gt;
            </div>
        </div>
        
        <h2>2. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¨­å®š</h2>
        <div class="critical">
            <p><strong>å•é¡Œ:</strong> å¿…è¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ãŒä¸è¶³</p>
            <p><strong>ãƒªã‚¹ã‚¯:</strong> ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã€MIMEã‚¿ã‚¤ãƒ—æ··ä¹±æ”»æ’ƒã€ä¸­é–“è€…æ”»æ’ƒ</p>
        </div>
        
        <div class="recommendation">
            <h4>ã‚µãƒ¼ãƒãƒ¼è¨­å®šã«è¿½åŠ ãŒå¿…è¦:</h4>
            <div class="code-block">
# Apache .htaccess ã®å ´åˆ
Header always set X-Frame-Options "DENY"
Header always set X-Content-Type-Options "nosniff"
Header always set X-XSS-Protection "1; mode=block"
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
Header always set Referrer-Policy "strict-origin-when-cross-origin"
Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"

# Nginx ã®å ´åˆ
add_header X-Frame-Options "DENY" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
            </div>
        </div>
        
        <h2>3. DOMæ“ä½œã®å®‰å…¨æ€§</h2>
        <div class="critical">
            <p><strong>å•é¡Œ:</strong> innerHTML ã«ã‚ˆã‚‹å®‰å…¨ã§ãªã„DOMæ“ä½œ</p>
            <p><strong>å ´æ‰€:</strong> cart.js, multilang.js, main.js</p>
            <p><strong>ãƒªã‚¹ã‚¯:</strong> XSSè„†å¼±æ€§ã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³</p>
        </div>
        
        <div class="recommendation">
            <h4>ä¿®æ­£ä¾‹:</h4>
            <div class="code-block">
// å±é™ºãªæ–¹æ³•
element.innerHTML = userInput;

// å®‰å…¨ãªæ–¹æ³•
element.textContent = userInput;

// HTMLãŒå¿…è¦ãªå ´åˆ
function sanitizeHTML(str) {
    const temp = document.createElement('div');
    temp.textContent = str;
    return temp.innerHTML;
}
element.innerHTML = sanitizeHTML(userInput);
            </div>
        </div>
        
        <div class="medium">
            <h3><span class="status medium">MEDIUM</span> å¯¾å¿œãŒæ¨å¥¨ã•ã‚Œã‚‹å•é¡Œ</h3>
        </div>
        
        <h2>4. å¤–éƒ¨ä¾å­˜é–¢ä¿‚ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h2>
        <div class="medium">
            <p><strong>å•é¡Œ:</strong> SRI (Subresource Integrity) ãƒã‚§ãƒƒã‚¯ãªã—ã§å¤–éƒ¨ãƒªã‚½ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã¿</p>
            <p><strong>ãƒªã‚¹ã‚¯:</strong> CDNä¾µå®³æ™‚ã®ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³æ”»æ’ƒ</p>
        </div>
        
        <div class="recommendation">
            <h4>SRIãƒãƒƒã‚·ãƒ¥ã®è¿½åŠ :</h4>
            <div class="code-block">
&lt;script src="https://js.stripe.com/v3/" 
        integrity="sha384-[hash]" 
        crossorigin="anonymous"&gt;&lt;/script&gt;

&lt;link href="https://fonts.googleapis.com/css2?family=..." 
      integrity="sha384-[hash]" 
      crossorigin="anonymous"&gt;
            </div>
        </div>
        
        <h2>5. ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h2>
        <div class="medium">
            <p><strong>å•é¡Œ:</strong> localStorageã«æš—å·åŒ–ãªã—ã§æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜</p>
            <p><strong>ãƒªã‚¹ã‚¯:</strong> ã‚»ãƒƒã‚·ãƒ§ãƒ³æŒç¶šæ€§ã€æ‚ªæ„ã®ã‚ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹ã‚¢ã‚¯ã‚»ã‚¹</p>
        </div>
        
        <div class="recommendation">
            <h4>æ¨å¥¨å¯¾ç­–:</h4>
            <ul>
                <li>æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã¯æš—å·åŒ–ã—ã¦ã‹ã‚‰ä¿å­˜</li>
                <li>ä¸€æ™‚çš„ãªãƒ‡ãƒ¼ã‚¿ã¯sessionStorageã‚’ä½¿ç”¨</li>
                <li>ãƒ‡ãƒ¼ã‚¿ã®æœ‰åŠ¹æœŸé™ã‚’è¨­å®š</li>
                <li>ä¸è¦ã«ãªã£ãŸãƒ‡ãƒ¼ã‚¿ã¯å‰Šé™¤</li>
            </ul>
        </div>
        
        <h2>6. ä¾¡æ ¼æ¤œè¨¼ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h2>
        <div class="medium">
            <p><strong>å•é¡Œ:</strong> ä¾¡æ ¼ãƒ­ã‚¸ãƒƒã‚¯ãŒã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®ã¿ã§å‡¦ç†</p>
            <p><strong>ãƒªã‚¹ã‚¯:</strong> ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã®å¤‰æ›´ã«ã‚ˆã‚‹ä¾¡æ ¼æ“ä½œ</p>
        </div>
        
        <div class="recommendation">
            <h4>æ¨å¥¨å¯¾ç­–:</h4>
            <ul>
                <li>ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ã®ä¾¡æ ¼æ¤œè¨¼ã‚’å®Ÿè£…</li>
                <li>æ±ºæ¸ˆæ™‚ã®ä¾¡æ ¼å†æ¤œè¨¼</li>
                <li>ä¾¡æ ¼å¤‰æ›´ã®ç›£æŸ»ãƒ­ã‚°</li>
            </ul>
        </div>
        
        <div class="low">
            <h3><span class="status low">LOW</span> ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h3>
        </div>
        
        <h2>7. å…¥åŠ›æ¤œè¨¼ã®å¼·åŒ–</h2>
        <div class="low">
            <p><strong>æ”¹å–„ç‚¹:</strong> ã‚ˆã‚Šå³å¯†ãªå…¥åŠ›æ¤œè¨¼ã®å®Ÿè£…</p>
        </div>
        
        <div class="recommendation">
            <h4>æ¨å¥¨å®Ÿè£…:</h4>
            <div class="code-block">
function validateEmail(email) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return emailRegex.test(email);
}

function validatePhone(phone) {
    const phoneRegex = /^[+]?[\d\s\-\(\)]+$/;
    return phoneRegex.test(phone) && phone.replace(/\D/g, '').length >= 10;
}

function sanitizeInput(input) {
    return input.trim().replace(/[<>]/g, '');
}
            </div>
        </div>
        
        <h2>8. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®å®Ÿè£…</h2>
        <div class="low">
            <p><strong>æ”¹å–„ç‚¹:</strong> ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã¨APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™</p>
        </div>
        
        <div class="recommendation">
            <h4>æ¨å¥¨å¯¾ç­–:</h4>
            <ul>
                <li>ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡ã®ãƒ¬ãƒ¼ãƒˆåˆ¶é™</li>
                <li>æ©Ÿå¯†ãƒ•ã‚©ãƒ¼ãƒ ã«CAPTCHAè¿½åŠ </li>
                <li>ç•°å¸¸ãªæ´»å‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç›£è¦–</li>
            </ul>
        </div>
        
        <h2>ğŸ”§ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h2>
        
        <div class="recommendation">
            <h4>ç·Šæ€¥å¯¾å¿œ (24æ™‚é–“ä»¥å†…):</h4>
            <ul>
                <li>â˜ CSPãƒ˜ãƒƒãƒ€ãƒ¼ã®å®Ÿè£…</li>
                <li>â˜ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¨­å®š</li>
                <li>â˜ innerHTMLä½¿ç”¨ç®‡æ‰€ã®ä¿®æ­£</li>
            </ul>
            
            <h4>ä¸­æœŸå¯¾å¿œ (1é€±é–“ä»¥å†…):</h4>
            <ul>
                <li>â˜ SRIãƒãƒƒã‚·ãƒ¥ã®è¿½åŠ </li>
                <li>â˜ ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®æš—å·åŒ–</li>
                <li>â˜ ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ä¾¡æ ¼æ¤œè¨¼ã®å®Ÿè£…</li>
                <li>â˜ ãƒ†ã‚¹ãƒˆç”¨URLã®å‰Šé™¤</li>
            </ul>
            
            <h4>é•·æœŸæ”¹å–„ (1ãƒ¶æœˆä»¥å†…):</h4>
            <ul>
                <li>â˜ å…¥åŠ›æ¤œè¨¼ã®å¼·åŒ–</li>
                <li>â˜ ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®å®Ÿè£…</li>
                <li>â˜ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç›£è¦–ã®å°å…¥</li>
                <li>â˜ å®šæœŸçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³</li>
            </ul>
        </div>
        
        <h2>ğŸ“ ã‚µãƒãƒ¼ãƒˆæƒ…å ±</h2>
        <div class="recommendation">
            <p><strong>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã«é–¢ã™ã‚‹è³ªå•ã‚„æ‡¸å¿µäº‹é …ãŒã‚ã‚‹å ´åˆ:</strong></p>
            <ul>
                <li>ğŸ“§ security@fomus-parure.com</li>
                <li>ğŸ”’ ã“ã®ã‚¬ã‚¤ãƒ‰ã®å®šæœŸçš„ãªè¦‹ç›´ã—ã‚’æ¨å¥¨</li>
                <li>ğŸ›¡ï¸ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¤ãƒ³ã‚·ãƒ‡ãƒ³ãƒˆç™ºç”Ÿæ™‚ã®å³åº§ãªå ±å‘Š</li>
            </ul>
        </div>
    </div>
    
    <script>
        // ã“ã®ãƒšãƒ¼ã‚¸è‡ªä½“ã‚‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã«å¾“ã†
        document.addEventListener('DOMContentLoaded', function() {
            // XSSãƒ†ã‚¹ãƒˆé˜²æ­¢
            const urlParams = new URLSearchParams(window.location.search);
            for (const [key, value] of urlParams) {
                if (value.includes('<script>') || value.includes('javascript:')) {
                    console.warn('Potentially malicious URL parameter detected');
                    window.location.href = window.location.pathname;
                    break;
                }
            }
        });
    </script>
</body>
</html>